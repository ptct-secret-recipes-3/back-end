
## Ptct-Secret-Recipes-3
### Back-End
*Notes for Front-End*

Below you'll find the info you need to build the front-end, including the baseURL, API endpoints, and the data schemas.
#### Base URL: (localhost vs. heroku - incomplete)
TESTING
- http://locahost:5000/api

AFTER DEPLOY
- https://ptct-secret-recipes-3.herokuapp.com/
- 

#### API Endpoints: 

- Login:  [POST]`/api/login` checks users login credentials against the database
- Register: [POST]`/api/register` tests users credentials against the db and stores it

    ##### CRUD Endpoints (GET/POST/UPDATE/DELETE)
    - `[GET] /api/recipes` returns an array of recipes (or an empty array if there aren't any).
    - `[GET] /api/recipes/:id` returns a recipe by the given id.
    - `[POST] /api/recipes` returns the created recipe. 
    - `[PUT] /api/recipes/:id` returns the updated recipe. 
    - `[DELETE] /api/recipes/:id` returns the deleted recipe.
 
#### DATA SCHEMAS 
(***Back-end: Create Seeds & Migration tables using Knex***)
 **Please remember it is critical that you create your state exactly as you see the JSON output above, otherwise, you will not be able to access the db.**
##### LOGIN (_user_)

| field       | data type           |
| ----------- | --------------------|
| username    | string, required    |
| password    | string, required    |

 - returned JSON example:

    {
        "username": "Wrenley",

        "password": "Willow1357"
    }

##### REGISTER (_user_)

| field       | data type             |
| ----------- | ----------------------|
| username    | string, required      |
| password    | string, required      |
| email       | string, required      |

- returned JSON example: 

    {
        "username": "Wrenley",

        "password": "Willow1357",

        "email": "AliceInWonderland@gmail.com"
    }


#### RECIPES SCHEMA (_recipe_)

| field       | data type        | metadata                                            |
| ----------- | ---------------- | --------------------------------------------------- |
| id          | unsigned integer | primary key, auto-increments, generated by database |
| title       | string           | required, unique                                    |
| source      | string           | required                                            |
| ingredients | string           | required                                            |
| instructions| array            | required                                            |
| category    | string           | optional                                            |

- returned JSON example:

_recipes_


  [
    {
        "id": 1,
        "title": "Kumandra Stew",
        "source": "Raya and Sisu",
        "ingredients": "water, ginger, noodles, tumeric, lemonzest",
        "instructions": ["directly infuse compassion and perspective", "Add 2 cups of water"],
        "category": "soups & stews"

    },
    {
        "id": 2,
        "title": "Lasagna",
        "source": "Luca",
        "ingredients": "pasta, marinara, mozzarella",
        "instructions": ["hop on your vespa", "ride into town to buy cheese", "boil water"],
        "category": "pasta"

    }
  ]

--------------------------------------------------------------------------------------------------------------------------------------
### *Back-End only notes:*

- `npm` commands (create scripts in package.json): 
    - `npm run server`
    - `npm run migrate`
    - `npm run seed`
    - `npm reset db`
    (Include testing scripts - create a testing db)
#### *Build Model Functions*

- db access functions inside `api/recipes/recipes-model.js` using Knex:

  - `getAll` resolves to an array of recipes (or an empty array)
  - `getById` resolves to an recipe by the given id
  - `create` resolves to the newly created recipe
  - `updateById` resolves to the updated recipe
  - `deleteById` resolves to the deleted recipe

#### *Write Middleware*

- Inside `api/middleware/recipes-middleware.js`:

  - `checkRecipePayload` returns a status 400 with if `req.body` is invalid:

    - If either _title_  _source_ _ingredients_ or _instructions_ are undefined, return `{ message: "All fields are required" }`
    - If _title_ is not a string, return `{ message: "title of recipe must be a string" }`
    - If the _title_ is shorter than 3 or longer than 100, return `{ message: "title of recipe must be between 3 and 100" }`

  - `checkRecipeId` returns a status 404 with a `{ message: "recipe not found" }` if `req.params.id` does not exist in the database

  - `checkTitleNameUnique` returns a status 400 with a `{ message: "That recipe has already been added!" }` if the `req.body.name` already exists in the database

- Inside `api/middleware/restricted.js`: (For the login endpoint)

    -`restricted` returns the token upon user credential validation. 

---------------------------------------------------------------------------------------------------------------------------------------
  
Basic Markdown syntax guide:
https://www.markdownguide.org/basic-syntax/
